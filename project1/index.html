<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Project 1</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 20px auto;
            text-align: left;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        h2 {
            color: #8e1600;
            text-align: center;
            margin-top: 20px;
        }
        h3 {
            color: #000000;
            margin: 20px 0 10px 0;
        }
        p {
            margin: 10px 0;
        }
                table {
            border-collapse: collapse;
            width: 100%;
            text-align: center;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ccc;
        }
        th, td {
            padding: 10px;
        }
        img {
            max-width: 400px;
            height: auto;
        }
    </style>
</head>
<body>
    <h1>Project 1</h1>
    <h2>Images of the Russian Empire -- Colorizing the Prokudin-Gorskii Photo Collection</h2>

    <h3>Motivation</h3>
    <p>
        Since elementary school, weâ€™ve learned that a small set of primary colors can combine to produce the full spectrum of visible colors. Before color photography existed, images were captured in black and white. However, the same scene could be recorded at different intensities of red, green, and blue light. Photographer Sergei Prokudin-Gorskii took advantage of this by capturing three separate exposures, one for each RGB channel, allowing us to reconstruct fully colored photographs.
    </p>

    <h2>Approach</h2>

    <h3>Simple Approach</h3>
    <p>
        After dissecting the original image to get the three color channels, I first dealt with smaller images. I created a sliding window approach using the blue channel as a reference for both red and green. By comparing sections of the blue channel with windows on the R/G channels, the alignment with the lowest loss or highest similarity was selected. This works because regions with high intensity in one channel generally correspond to high intensity in the others.
    </p>
    <p>
        Initially, I used the Euclidean difference (L2 norm) between pixels to evaluate alignment. Later, I used the normalized cross-correlation (NCC) norm, which improved results for smaller images. The search window was initially large (-40 to 40 px), but recursion allowed smaller search ranges (-15 to 15 px or even -4 to 4 px) for efficiency. Cropping borders further reduced misalignment due to edge artifacts.
    </p>

    <h3>Image Pyramid Approach</h3>
    <p>
        The one-pass brute-force method was too slow for large images. Using an image pyramid (downscale by 0.5, upscale by 2), I aligned a smaller version first, then refined the alignment recursively at higher resolutions. A challenge was handling odd dimensions during rescaling; pixels could get truncated, so I returned shift values rather than rescaled images to maintain consistency.
    </p>
    <p>
        Some images, like emir.tif, required larger shifts, possibly due to camera angle or differences in channel sensitivity, especially in blue. I also experimented with Sobel edge detection to align based on edges, then applied the calculated shifts to the actual RGB channels.
    </p>

    <h3>Overall</h3>
    <p>
        Recursion worked well, though index bounds were sometimes tricky. I also explored additional images of cotton mills, which relate to my family history in the textile industry. Seeing the machinary in these photographs connects to the era my grandfather worked in and how the textile industry shaped our family's journey.
    </p>
     <h2>Results</h2>
<table>
    <thead>
        <tr>
            <th>Image</th>
            <th>Filename</th>
            <th>Red Offset (y, x)</th>
            <th>Green Offset (y, x)</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><img src="aligned_outputs/cathedral_aligned.jpg" alt="Cathedral"></td>
            <td>cathedral.jpg</td>
            <td>(3, 12)</td>
            <td>(2, 5)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/monastery_aligned.jpg" alt="Monastery"></td>
            <td>monastery.jpg</td>
            <td>(2, 3)</td>
            <td>(2, -3)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/tobolsk_aligned.jpg" alt="Tobolsk"></td>
            <td>tobolsk.jpg</td>
            <td>(3, 6)</td>
            <td>(2, 3)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/church_aligned.jpg" alt="Church"></td>
            <td>church.tif</td>
            <td>(-4, 58)</td>
            <td>(4, 25)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/emir_aligned.jpg" alt="Emir"></td>
            <td>emir.tif</td>
            <td>(40, 107)</td>
            <td>(24, 49)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/harvesters_aligned.jpg" alt="Harvesters"></td>
            <td>harvesters.tif</td>
            <td>(11, 125)</td>
            <td>(18, 60)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/icon_aligned.jpg" alt="Icon"></td>
            <td>icon.tif</td>
            <td>(23, 89)</td>
            <td>(16, 40)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/italil_aligned.jpg" alt="Italil"></td>
            <td>italil.tif</td>
            <td>(36, 78)</td>
            <td>(22, 39)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/lastochikino_aligned.jpg" alt="Lastochikino"></td>
            <td>lastochikino.tif</td>
            <td>(-8, 75)</td>
            <td>(-2, -3)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/melons_aligned.jpg" alt="Melons"></td>
            <td>melons.tif</td>
            <td>(12, 176)</td>
            <td>(10, 80)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/self_portrait_aligned.jpg" alt="Self Portrait"></td>
            <td>self_portrait.tif</td>
            <td>(37, 175)</td>
            <td>(30, 80)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/siren_aligned.jpg" alt="Siren"></td>
            <td>siren.tif</td>
            <td>(-24, 96)</td>
            <td>(-6, 49)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/three_generations_aligned.jpg" alt="Three Generations"></td>
            <td>three_generations.tif</td>
            <td>(8, 110)</td>
            <td>(12, 54)</td>
        </tr>
                <tr>
            <td><img src="aligned_outputs/mill1_aligned.jpg" alt="Melons"></td>
            <td>mill1.tif</td>
            <td>(na)</td>
            <td>(na)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/mill2_aligned.jpg" alt="Self Portrait"></td>
            <td>mill2.tif</td>
               <td>(na)</td>
            <td>(na)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/mill3_aligned.jpg" alt="Siren"></td>
            <td>mill3.tif</td>
             <td>(na)</td>
            <td>(na)</td>
        </tr>
        <tr>
            <td><img src="aligned_outputs/mill4_aligned.jpg" alt="Three Generations"></td>
            <td>mill4.tif</td>
               <td>(na)</td>
            <td>(na)</td>
        </tr>
    </tbody>
</table>

</body>
</html>
